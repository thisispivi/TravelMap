import{d as e,j as o,l as t,r as n,M as a}from"./vendor-DKZVa1wl.js";import{u as s,M as r,C as l,Z as i,G as c,a as m}from"./map-BRUXIl5C.js";import{a as d,v as p,f as _,l as u}from"./data-BNyqb9EO.js";import{p as h}from"./parameters-DqczkKOP.js";import{u as v,B as j,H as x,L as y}from"./index-BNB0d5IQ.js";import{M as f,q as g,r as N,t as b,x as k,y as M}from"./icons-C71SayX9.js";import{f as C}from"./date-DdS6Itap.js";import{C as S}from"./CountryFlag-BvMsS2nw.js";import"./gallery-DOdM-sjS.js";function L(t){const n=e.c(16),{city:a,hoveredCity:l,setHoveredCity:i,baseZoom:c,defaultScale:m,minScale:d,maxScale:p,isFuture:_,isLived:u}=t,v=void 0===c?h.map.defaultZoom:c,j=void 0===m?h.map.marker.defaultScale:m;let x=void 0===d?h.map.marker.minScale:d,y=void 0===p?h.map.marker.maxScale:p;const g=void 0!==_&&_,N=void 0!==u&&u,{k:b}=s(),k=j*(v/b);x=a.country.minMarkerScale||x,y=a.country.maxMarkerScale||y;const M=Math.min(Math.max(k,x),y),C=l?.name===a.name,S=a.name+"-marker";let L,E,w;n[0]!==a||n[1]!==i?(L=()=>i&&i(a),n[0]=a,n[1]=i,n[2]=L):L=n[2],n[3]!==i?(E=()=>i&&i(null),n[3]=i,n[4]=E):E=n[4],n[5]===Symbol.for("react.memo_cache_sentinel")?(w={default:{outline:"none"},hover:{outline:"none"},pressed:{outline:"none"}},n[5]=w):w=n[5];const $=`${C?"marker-icon--hovered":""}\n          ${g?"marker-icon--future":""}\n          ${N?"marker-icon--lived":""}\n        `;let F,Z;return n[6]!==M||n[7]!==$?(F=o.jsx(f,{className:$,scale:M}),n[6]=M,n[7]=$,n[8]=F):F=n[8],n[9]!==a.coordinates||n[10]!==a.name||n[11]!==F||n[12]!==S||n[13]!==L||n[14]!==E?(Z=o.jsx(r,{coordinates:a.coordinates,id:S,onMouseEnter:L,onMouseLeave:E,style:w,children:F},a.name),n[9]=a.coordinates,n[10]=a.name,n[11]=F,n[12]=S,n[13]=L,n[14]=E,n[15]=Z):Z=n[15],Z}function E(a){const s=e.c(57),{city:r,onMouseEnter:l,onMouseLeave:i,setIsOpen:c}=a,m=t();let d;s[0]===Symbol.for("react.memo_cache_sentinel")?(d=["home"],s[0]=d):d=s[0];const{t:p,currLanguage:_}=v(d),[u,h]=n.useState(0),x=r.travels.filter(w);let y;s[1]!==r||s[2]!==l||s[3]!==i?(y=e=>o.jsx("div",{className:`map-tooltip__backdrop ${e}`,onMouseEnter:()=>l&&l(r),onMouseLeave:()=>i&&i()}),s[1]=r,s[2]=l,s[3]=i,s[4]=y):y=s[4];const f=y;let L,E,$,F,Z,z;s[5]!==c?(L=()=>{const e=()=>document.hidden&&c(!1);return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},E=[c],s[5]=c,s[6]=L,s[7]=E):(L=s[6],E=s[7]),n.useEffect(L,E),s[8]!==f?($=f("map-tooltip__backdrop--top"),F=f("map-tooltip__backdrop--right"),Z=f("map-tooltip__backdrop--bottom"),z=f("map-tooltip__backdrop--left"),s[8]=f,s[9]=$,s[10]=F,s[11]=Z,s[12]=z):($=s[9],F=s[10],Z=s[11],z=s[12]);let H,D,I,O,A,W,B,P,T,q;s[13]!==r||s[14]!==l?(H=()=>l&&l(r),s[13]=r,s[14]=l,s[15]=H):H=s[15],s[16]!==i?(D=()=>i&&i(),s[16]=i,s[17]=D):D=s[17],s[18]!==r||s[19]!==p?(I=r.getName(p),s[18]=r,s[19]=p,s[20]=I):I=s[20],s[21]!==I?(O=o.jsx("h2",{children:I}),s[21]=I,s[22]=O):O=s[22],s[23]!==r.country.id?(A=o.jsx(S,{countryId:r.country.id}),s[23]=r.country.id,s[24]=A):A=s[24],s[25]!==O||s[26]!==A?(W=o.jsxs("div",{className:"map-tooltip__header",children:[O,A]}),s[25]=O,s[26]=A,s[27]=W):W=s[27],s[28]===Symbol.for("react.memo_cache_sentinel")?(B=o.jsx(k,{className:"map-tooltip__metadata__icon"}),s[28]=B):B=s[28],s[29]!==r.population||s[30]!==_?(P=r.population?r.population.toLocaleString(_):"-",s[29]=r.population,s[30]=_,s[31]=P):P=s[31],s[32]!==P?(T=o.jsxs("div",{className:"map-tooltip__metadata__item",children:[B,P]}),s[32]=P,s[33]=T):T=s[33],s[34]===Symbol.for("react.memo_cache_sentinel")?(q=o.jsx(M,{className:"map-tooltip__metadata__icon"}),s[34]=q):q=s[34];const G=p(`currency.${r.country.currency}.name`);let K;s[35]!==G?(K=o.jsx("p",{className:"currency-row__name",children:G}),s[35]=G,s[36]=K):K=s[36];const R=" "+p(`currency.${r.country.currency}.symbol`);let Y,J,Q;s[37]!==R?(Y=o.jsx("b",{className:"currency-row__symbol",children:R}),s[37]=R,s[38]=Y):Y=s[38],s[39]!==K||s[40]!==Y?(J=o.jsxs("div",{className:"map-tooltip__metadata__item",children:[q,K,Y]}),s[39]=K,s[40]=Y,s[41]=J):J=s[41],s[42]!==T||s[43]!==J?(Q=o.jsxs("div",{className:"map-tooltip__metadata",children:[T,J]}),s[42]=T,s[43]=J,s[44]=Q):Q=s[44];const U=x[u]?o.jsxs("div",{className:"map-tooltip__divider",children:[o.jsx("div",{className:"map-tooltip__content",children:o.jsxs("div",{className:"map-tooltip__content__travels",children:[o.jsxs("b",{className:"map-tooltip__content__travels__title",children:[p("selectedTravel")," ",u+1," /"," ",x.length]}),o.jsxs("div",{className:"map-tooltip__content__travels__selector",children:[o.jsx(g,{className:"map-tooltip__content__chevron-icon map-tooltip__content__chevron-icon--left "+(u>0?"":"map-tooltip__content__chevron-icon--disabled"),onClick:()=>u>0&&h(u-1)}),o.jsxs("div",{className:"map-tooltip__content__travel",children:[o.jsx(N,{className:"map-tooltip__content__travel__icon"}),o.jsx("p",{children:C({sDateInput:x[u].sDate,eDateInput:x[u].eDate,locale:_,includeWeekday:!0,showYear:!0})})]}),o.jsx(g,{className:"map-tooltip__content__chevron-icon "+(u<x.length-1?"":"map-tooltip__content__chevron-icon--disabled"),onClick:()=>u<x.length-1&&h(u+1)})]})]})}),x[u].photos&&x[u].photos.length>0?o.jsx("div",{className:"map-tooltip__footer",children:o.jsxs(j,{className:"map-tooltip__footer__button",onClick:()=>m(`/gallery/${r.name}/${u}?from=map`),children:[o.jsx(b,{}),o.jsx("p",{children:p("galleryAlt")})]})}):null]}):null;let V,X;return s[45]!==H||s[46]!==D||s[47]!==W||s[48]!==Q||s[49]!==U?(V=o.jsxs("div",{className:"map-tooltip__container",onMouseEnter:H,onMouseLeave:D,children:[W,Q,U]}),s[45]=H,s[46]=D,s[47]=W,s[48]=Q,s[49]=U,s[50]=V):V=s[50],s[51]!==V||s[52]!==$||s[53]!==F||s[54]!==Z||s[55]!==z?(X=o.jsxs(o.Fragment,{children:[$,F,Z,z,V]}),s[51]=V,s[52]=$,s[53]=F,s[54]=Z,s[55]=z,s[56]=X):X=s[56],X}function w(e){return!e.isFuture}const $=(e,o)=>{const t=e.coordinates[0],n=o.coordinates[0],a=e.coordinates[1],s=o.coordinates[1];return a<s?1:a>s||t<n?-1:t>n?1:0},F={default:{outline:"none"},hover:{outline:"none"},pressed:{outline:"none"}},Z={scale:160};function z(t){const a=e.c(11),{geographies:s,getCountryFillColor:r,onLoaded:l}=t,i=n.useRef(!1);let c,d,p,_;if(a[0]!==s.length||a[1]!==l?(c=()=>{!i.current&&s.length>0&&(i.current=!0,l())},d=[s.length,l],a[0]=s.length,a[1]=l,a[2]=c,a[3]=d):(c=a[2],d=a[3]),n.useEffect(c,d),a[4]!==s||a[5]!==r){let e;a[7]!==r?(e=e=>o.jsx(m,{fill:r(e.properties.name),geography:e,strokeWidth:0,style:F},e.rsmKey),a[7]=r,a[8]=e):e=a[8],p=s.map(e),a[4]=s,a[5]=r,a[6]=p}else p=a[6];return a[9]!==p?(_=o.jsx(o.Fragment,{children:p}),a[9]=p,a[10]=_):_=a[10],_}function H(){const t=e.c(70),s=n.useContext(x),{isDarkTheme:r,hoveredCity:m,setHoveredCity:v,mapPosition:j,responsive:f,setMapPosition:g}=s,[N,b]=n.useState(!1);let k;t[0]===Symbol.for("react.memo_cache_sentinel")?(k=Object.fromEntries(d.map(D)),t[0]=k):k=t[0];const M=k;let C;t[1]!==r?(C=e=>M[e]??(r?"#1a1a1a":"#dadada"),t[1]=r,t[2]=C):C=t[2];const S=C;let w,F,H,I,O,A,W,B,P,T,q,G,K,R,Y,J,Q,U,V,X;if(t[3]!==S||t[4]!==m||t[5]!==N||t[6]!==j.center||t[7]!==j.zoom||t[8]!==f.window||t[9]!==v||t[10]!==g){const e=[...p].sort($),n=[..._].sort($),a=[...u].sort($);let s;t[29]===Symbol.for("react.memo_cache_sentinel")?(s=()=>{b(!0)},t[29]=s):s=t[29];const r=s;let d;t[30]!==g?(d=e=>{g({center:e.coordinates,zoom:e.zoom})},t[30]=g,t[31]=d):d=t[31];const x=d;let k;t[32]!==m||t[33]!==v?(k=(e,t)=>e.map(e=>o.jsx(L,{city:e,hoveredCity:m,setHoveredCity:v,...t},e.name)),t[32]=m,t[33]=v,t[34]=k):k=t[34];const M=k;let C;C=m?`#${CSS.escape(`${m.name}-marker`)}`:"",U=C;const E=f.window;W="map-container",B=E,t[35]!==N||t[36]!==E?(P=N?null:o.jsx("div",{className:"loading",style:E,children:o.jsx(y,{})}),t[35]=N,t[36]=E,t[37]=P):P=t[37],F=l,Q="map",H="",I="geoMercator",O=Z,A=E,w=i,T=j.center,q=h.map.defaultMaxZoom,G=h.map.defaultMinZoom,K=x,R=j.zoom,t[38]!==S?(Y=o.jsx(c,{geography:"/assets/countries-50m-BgWjA-HH.json",children:e=>{const{geographies:t}=e;return t.length>0?o.jsx(z,{geographies:t,getCountryFillColor:S,onLoaded:r}):null}}),t[38]=S,t[39]=Y):Y=t[39],J=N?o.jsxs(o.Fragment,{children:[M(e),M(n,{isFuture:!0}),M(a,{isLived:!0})]}):null,t[3]=S,t[4]=m,t[5]=N,t[6]=j.center,t[7]=j.zoom,t[8]=f.window,t[9]=v,t[10]=g,t[11]=w,t[12]=F,t[13]=H,t[14]=I,t[15]=O,t[16]=A,t[17]=W,t[18]=B,t[19]=P,t[20]=T,t[21]=q,t[22]=G,t[23]=K,t[24]=R,t[25]=Y,t[26]=J,t[27]=Q,t[28]=U}else w=t[11],F=t[12],H=t[13],I=t[14],O=t[15],A=t[16],W=t[17],B=t[18],P=t[19],T=t[20],q=t[21],G=t[22],K=t[23],R=t[24],Y=t[25],J=t[26],Q=t[27],U=t[28];t[40]!==w||t[41]!==T||t[42]!==q||t[43]!==G||t[44]!==K||t[45]!==R||t[46]!==Y||t[47]!==J?(V=o.jsxs(w,{center:T,maxZoom:q,minZoom:G,onMoveEnd:K,zoom:R,children:[Y,J]}),t[40]=w,t[41]=T,t[42]=q,t[43]=G,t[44]=K,t[45]=R,t[46]=Y,t[47]=J,t[48]=V):V=t[48],t[49]!==F||t[50]!==H||t[51]!==I||t[52]!==O||t[53]!==A||t[54]!==V||t[55]!==Q?(X=o.jsx(F,{className:Q,"data-tip":H,projection:I,projectionConfig:O,...A,children:V}),t[49]=F,t[50]=H,t[51]=I,t[52]=O,t[53]=A,t[54]=V,t[55]=Q,t[56]=X):X=t[56];const ee=!!m;let oe,te,ne;return t[57]!==m||t[58]!==v?(oe=m?o.jsx(E,{city:m,onMouseEnter:e=>v(e),onMouseLeave:()=>v(null),setIsOpen:e=>v(e?m:null)}):null,t[57]=m,t[58]=v,t[59]=oe):oe=t[59],t[60]!==ee||t[61]!==oe||t[62]!==U?(te=o.jsx(a,{anchorSelect:U,clickable:!0,id:"map-tooltip",isOpen:ee,noArrow:!0,opacity:1,variant:"light",children:oe}),t[60]=ee,t[61]=oe,t[62]=U,t[63]=te):te=t[63],t[64]!==W||t[65]!==B||t[66]!==P||t[67]!==X||t[68]!==te?(ne=o.jsxs("div",{className:W,style:B,children:[P,X,te]}),t[64]=W,t[65]=B,t[66]=P,t[67]=X,t[68]=te,t[69]=ne):ne=t[69],ne}function D(e){return[e.id,e.fillColor]}export{H as Map};
