import{r as p,u as O,a as G,b as H,j as w,C as B,T as D,c as T,O as V}from"./index-sh0UKyrn.js";import{u as Z}from"./language-dtidq5SZ.js";import"./useTranslation-xqisE_th.js";function C({width:t,height:o}){return t/o}function P(t,o=0){const e=10**o;return Math.round((t+Number.EPSILON)*e)/e}function q(t){return(o,e)=>t(e)-t(o)}class Q{constructor(o){this.comparator=o,this.heap=[],this.n=0}greater(o,e){return this.comparator(this.heap[o],this.heap[e])<0}swap(o,e){const n=this.heap[o];this.heap[o]=this.heap[e],this.heap[e]=n}swim(o){let e=o,n=Math.floor(e/2);for(;e>1&&this.greater(n,e);)this.swap(n,e),e=n,n=Math.floor(e/2)}sink(o){let e=o,n=e*2;for(;n<=this.n&&(n<this.n&&this.greater(n,n+1)&&(n+=1),!!this.greater(e,n));)this.swap(e,n),e=n,n=e*2}push(o){this.n+=1,this.heap[this.n]=o,this.swim(this.n)}pop(){if(this.n===0)return;this.swap(1,this.n),this.n-=1;const o=this.heap.pop();return this.sink(1),o}size(){return this.n}}function U(t,o,e){const n=new Map,s=new Set,r=new Map;r.set(o,0);const a=new Q(q(c=>c.weight));for(a.push({id:o,weight:0});a.size()>0;){const{id:c,weight:i}=a.pop();if(!s.has(c)){const l=t(c);s.add(c),l.forEach((u,m)=>{const f=i+u,d=n.get(m),h=r.get(m);(h===void 0||h>f&&(h/f>1.005||d!==void 0&&d<c))&&(r.set(m,f),a.push({id:m,weight:f}),n.set(m,c))})}}return r.has(e)?n:void 0}function X(t,o){const e=[];for(let n=o;n!==void 0;n=t.get(n))e.push(n);return e.reverse()}function J(t,o,e){const n=U(t,o,e);return n?X(n,e):void 0}function K({photos:t,targetRowHeight:o,containerWidth:e}){const n=t.reduce((s,r)=>Math.min(C(r),s),Number.MAX_VALUE);return P(e/o/n)+2}function L(t,o,e,n){const s=o-(t.length-1)*e-2*n*t.length,r=t.reduce((a,c)=>a+C(c),0);return s/r}function Y(t,o,e,n,s,r,a){const c=t.slice(o,e),i=L(c,n,r,a);return i>0?(i-s)**2*c.length:void 0}function tt({photos:t,layoutOptions:o,targetRowHeight:e,limitNodeSearch:n,rowConstraints:s}){return r=>{var a,c;const{containerWidth:i,spacing:l,padding:u}=o,m=new Map;m.set(r,0);const f=(a=s==null?void 0:s.minPhotos)!=null?a:1,d=Math.min(n,(c=s==null?void 0:s.maxPhotos)!=null?c:1/0);for(let h=r+f;h<t.length+1&&!(h-r>d);h+=1){const g=Y(t,r,h,i,e,l,u);if(g===void 0)break;m.set(h,g)}return m}}function et({photos:t,layoutOptions:o}){const{spacing:e,padding:n,containerWidth:s,targetRowHeight:r,rowConstraints:a}=o,c=K({photos:t,containerWidth:s,targetRowHeight:r}),i=tt({photos:t,layoutOptions:o,targetRowHeight:r,limitNodeSearch:c,rowConstraints:a}),l=J(i,0,t.length);if(l===void 0)return;const u=[];for(let m=1;m<l.length;m+=1){const f=t.map((h,g)=>({photo:h,index:g})).slice(l[m-1],l[m]),d=L(f.map(({photo:h})=>h),s,e,n);u.push(f.map(({photo:h,index:g},y)=>({photo:h,layout:{height:d,width:d*C(h),index:g,photoIndex:y,photosCount:f.length}})))}return u}function R(...t){return[...t].filter(o=>!!o).join(" ")}function S(t,o,e){const{width:n,photosCount:s}=o,{layout:r,spacing:a,padding:c,containerWidth:i}=e,l=r==="rows"?s:e.columns,u=a*(l-1)+2*c*l;return`calc((${t} - ${u}px) / ${P((i-u)/n,5)})`}function nt(t,o){return o.layout!=="rows"?`calc(100% - ${2*o.padding}px)`:S("100%",t,o)}function N(t,o,e){var n,s;return S((s=(n=t.match(/^\s*calc\((.*)\)\s*$/))==null?void 0:n[1])!=null?s:t,o,e)}function ot(t,o,e){var n;let s,r;const a=t.srcSet||t.images;return a&&a.length>0&&(s=a.concat(a.find(({width:c})=>c===t.width)?[]:[{src:t.src,width:t.width,height:t.height}]).sort((c,i)=>c.width-i.width).map(c=>`${c.src} ${c.width}w`).join(", ")),(n=e.sizes)!=null&&n.size?r=(e.sizes.sizes||[]).map(({viewport:c,size:i})=>`${c} ${N(i,o,e)}`).concat(N(e.sizes.size,o,e)).join(", "):r=`${Math.ceil(o.width/e.containerWidth*100)}vw`,{srcSet:s,sizes:r}}function $(t){var o,e;const{photo:n,layout:s,layoutOptions:r,imageProps:{style:a,className:c,...i}={},renderPhoto:l}=t,{onClick:u}=r,m={display:"block",boxSizing:"content-box",width:nt(s,r),height:"auto",aspectRatio:`${n.width} / ${n.height}`,...r.padding?{padding:`${r.padding}px`}:null,...(r.layout==="columns"||r.layout==="masonry")&&s.photoIndex<s.photosCount-1?{marginBottom:`${r.spacing}px`}:null,...u?{cursor:"pointer"}:null,...a},f=u?y=>{u({event:y,photo:n,index:s.index})}:void 0,d={src:n.src,alt:(o=n.alt)!=null?o:"",title:n.title,onClick:f,style:m,className:R("react-photo-album--photo",c),loading:"lazy",decoding:"async",...ot(n,s,r),...i},h=y=>{const{src:M,alt:_,srcSet:v,sizes:b,style:k,...E}=d;return p.createElement("img",{alt:_,...v?{srcSet:v,sizes:b}:null,src:M,style:y!=null&&y.wrapped?{display:"block",width:"100%",height:"100%"}:k,...E})},g=(({display:y,boxSizing:M,width:_,aspectRatio:v,padding:b,marginBottom:k,cursor:E})=>({display:y,boxSizing:M,width:_,aspectRatio:v,padding:b,marginBottom:k,cursor:E}))(m);return p.createElement(p.Fragment,null,(e=l==null?void 0:l({photo:n,layout:s,layoutOptions:r,imageProps:d,renderDefaultPhoto:h,wrapperStyle:g}))!=null?e:h())}function rt({rowContainerProps:t,children:o}){return p.createElement("div",{...t},o)}function st(t){const{layoutOptions:o,rowIndex:e,rowsCount:n,renderRowContainer:s,rowContainerProps:{style:r,className:a,...c}={},children:i}=t,l={className:R("react-photo-album--row",a),style:{display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"flex-start",justifyContent:"space-between",...e<n-1?{marginBottom:`${o.spacing}px`}:null,...r},...c};return p.createElement(p.Fragment,null,(s??rt)({layoutOptions:o,rowIndex:e,rowsCount:n,rowContainerProps:l,children:i}))}function ct(t){const{photos:o,layoutOptions:e,renderPhoto:n,renderRowContainer:s,componentsProps:{imageProps:r,rowContainerProps:a}}=t,c=et({photos:o,layoutOptions:e});return c?p.createElement(p.Fragment,null,c.map((i,l)=>p.createElement(st,{key:`row-${l}`,layoutOptions:e,rowIndex:l,rowsCount:c.length,renderRowContainer:s,rowContainerProps:a},i.map(({photo:u,layout:m})=>p.createElement($,{key:u.key||u.src,photo:u,layout:m,layoutOptions:e,renderPhoto:n,imageProps:r}))))):null}function it(t,o,e,n){const s=new Map,r=new Set;r.add(e);for(let a=0;a<o;a+=1){const c=[...r.keys()];r.clear(),c.forEach(i=>{const l=a>0?s.get(i)[a].weight:0;t(i).forEach(({neighbor:u,weight:m})=>{let f=s.get(u);f||(f=[],s.set(u,f));const d=l+m,h=f[a+1];(!h||h.weight>d&&(h.weight/d>1.0001||i<h.node))&&(f[a+1]={node:i,weight:d}),a<o-1&&u!==n&&r.add(u)})})}return s}function at(t,o,e){const n=[e];for(let s=e,r=o;r>0;r-=1)s=t.get(s)[r].node,n.push(s);return n.reverse()}function lt(t,o,e,n){return at(it(t,o,e,n),o,n)}function ut({photos:t,spacing:o,padding:e,targetColumnWidth:n,targetColumnHeight:s}){return r=>{const a=[],c=s*1.5;let i=n/C(t[r])+2*e;for(let l=r+1;l<t.length+1&&(a.push({neighbor:l,weight:(s-i)**2}),!(i>c||l===t.length));l+=1)i+=n/C(t[l])+o+2*e;return a}}function W({path:t,photos:o,containerWidth:e,columnsGaps:n,columnsRatios:s,spacing:r,padding:a}){const c=[],i=s.reduce((l,u)=>l+u,0);for(let l=0;l<t.length-1;l+=1){const u=o.map((d,h)=>({photo:d,index:h})).slice(t[l],t[l+1]),m=s.reduce((d,h,g)=>d+(n[l]-n[g])*h,0),f=(e-(t.length-2)*r-2*(t.length-1)*a-m)*s[l]/i;c.push(u.map(({photo:d,index:h},g)=>({photo:d,layout:{width:f,height:f/C(d),index:h,photoIndex:g,photosCount:u.length}})))}return c}function dt({photos:t,layoutOptions:o,targetColumnWidth:e}){const{columns:n,spacing:s,padding:r,containerWidth:a}=o,c=[],i=[];if(t.length<=n){const d=t.length>0?t.reduce((g,y)=>g+C(y),0)/t.length:1;for(let g=0;g<n;g+=1)c[g]=2*r,i[g]=g<t.length?C(t[g]):d;const h=W({path:Array.from({length:n+1}).map((g,y)=>Math.min(y,t.length)),photos:t,columnsRatios:i,columnsGaps:c,containerWidth:a,spacing:s,padding:r});return{columnsGaps:c,columnsRatios:i,columnsModel:h}}const l=(t.reduce((d,h)=>d+e/C(h),0)+s*(t.length-n)+2*r*t.length)/n,u=ut({photos:t,targetColumnWidth:e,targetColumnHeight:l,spacing:s,padding:r}),m=lt(u,n,0,t.length);for(let d=0;d<m.length-1;d+=1){const h=t.slice(m[d],m[d+1]);c[d]=s*(h.length-1)+2*r*h.length,i[d]=1/h.reduce((g,y)=>g+1/C(y),0)}const f=W({path:m,photos:t,columnsRatios:i,columnsGaps:c,containerWidth:a,spacing:s,padding:r});return{columnsGaps:c,columnsRatios:i,columnsModel:f}}function z(t){const{photos:o,layoutOptions:e}=t,{columns:n,spacing:s,padding:r,containerWidth:a}=e,c=(a-s*(n-1)-2*r*n)/n,{columnsGaps:i,columnsRatios:l,columnsModel:u}=dt({photos:o,layoutOptions:e,targetColumnWidth:c});return u.findIndex(m=>m.findIndex(({layout:{width:f,height:d}})=>f<0||d<0)>=0)>=0?n>1?z({photos:o,layoutOptions:{...e,columns:n-1}}):void 0:{columnsModel:u,columnsGaps:i,columnsRatios:l}}function mt({photos:t,layoutOptions:o}){return z({photos:t,layoutOptions:o})}function ht({columnContainerProps:t,children:o}){return p.createElement("div",{...t},o)}function ft(t){const{layoutOptions:o,columnIndex:e,columnsCount:n,columnsGaps:s,columnsRatios:r}=t,{layout:a,spacing:c,padding:i}=o;if(a==="masonry"||!s||!r)return`calc((100% - ${c*(n-1)}px) / ${n})`;const l=r.reduce((m,f)=>m+f,0),u=r.reduce((m,f,d)=>m+(s[e]-s[d])*f,0);return`calc((100% - ${P((n-1)*c+2*n*i+u,3)}px) * ${P(r[e]/l,5)} + ${2*i}px)`}function I(t){const{layoutOptions:o,renderColumnContainer:e,children:n,columnContainerProps:{style:s,className:r,...a}={},...c}=t,i={className:R("react-photo-album--column",r),style:{display:"flex",flexDirection:"column",flexWrap:"nowrap",alignItems:"flex-start",width:ft(t),justifyContent:o.layout==="columns"?"space-between":"flex-start",...s},...a};return p.createElement(p.Fragment,null,(e??ht)({layoutOptions:o,columnContainerProps:i,children:n,...c}))}function pt(t){const{photos:o,layoutOptions:e,renderPhoto:n,renderColumnContainer:s,componentsProps:{imageProps:r,columnContainerProps:a}}=t,c=mt({photos:o,layoutOptions:e});if(!c)return null;const{columnsModel:i,columnsRatios:l,columnsGaps:u}=c;return p.createElement(p.Fragment,null,i.map((m,f)=>p.createElement(I,{key:`column-${f}`,layoutOptions:e,columnIndex:f,columnsCount:i.length,columnsGaps:u,columnsRatios:l,renderColumnContainer:s,columnContainerProps:a},m.map(({photo:d,layout:h})=>p.createElement($,{key:d.key||d.src,photo:d,layout:h,layoutOptions:e,renderPhoto:n,imageProps:r})))))}function A(t){const{photos:o,layoutOptions:e}=t,{columns:n,spacing:s,padding:r,containerWidth:a}=e,c=(a-s*(n-1)-2*r*n)/n;if(c<=0)return n>1?A({...t,layoutOptions:{...e,columns:n-1}}):void 0;const i=[];for(let u=0;u<n;u+=1)i[u]=0;return o.reduce((u,m,f)=>{const d=i.reduce((h,g,y)=>g<i[h]-1?y:h,0);return i[d]=i[d]+c/C(m)+s+2*r,u[d].push({photo:m,index:f}),u},Array.from({length:n}).map(()=>[])).map(u=>u.map(({photo:m,index:f},d)=>({photo:m,layout:{width:c,height:c/C(m),index:f,photoIndex:d,photosCount:u.length}})))}function gt(t){const{photos:o,layoutOptions:e,renderPhoto:n,renderColumnContainer:s,componentsProps:{imageProps:r,columnContainerProps:a}}=t,c=A({photos:o,layoutOptions:e});return c?p.createElement(p.Fragment,null,c.map((i,l)=>p.createElement(I,{key:`masonry-column-${l}`,layoutOptions:e,columnsCount:c.length,columnIndex:l,renderColumnContainer:s,columnContainerProps:a},i.map(({photo:u,layout:m})=>p.createElement($,{key:u.key||u.src,photo:u,layout:m,layoutOptions:e,renderPhoto:n,imageProps:r}))))):null}function yt({containerProps:t,children:o,containerRef:e}){return p.createElement("div",{ref:e,...t},o)}function wt(t){const{layout:o,renderContainer:e,children:n,containerRef:s,containerProps:{style:r,className:a,...c}={}}=t,i={className:R("react-photo-album",`react-photo-album--${o}`,a),style:{display:"flex",flexWrap:"nowrap",justifyContent:"space-between",flexDirection:o==="rows"?"column":"row",...r},...c};return p.createElement(p.Fragment,null,(e??yt)({containerProps:i,containerRef:s,layout:o,children:n}))}function Ct(t){const o=p.useRef(t);return(!t||!o.current||t.join()!==o.current.join())&&(o.current=t),o.current}function vt(t,{newContainerWidth:o,newScrollbarWidth:e}){const{containerWidth:n,scrollbarWidth:s}=t;return n!==void 0&&s!==void 0&&o!==void 0&&e!==void 0&&o>n&&o-n<=20&&e<s?{containerWidth:n,scrollbarWidth:e}:n!==o||s!==e?{containerWidth:o,scrollbarWidth:e}:t}function xt(t,o){let e=t==null?void 0:t.clientWidth;if(e!==void 0&&o&&o.length>0){const n=[...o.filter(r=>r>0)].sort((r,a)=>a-r);n.push(Math.floor(n[n.length-1]/2));const s=e;e=n.find((r,a)=>r<=s||a===n.length-1)}return e}function Pt(t,o){const[{containerWidth:e},n]=p.useReducer(vt,{containerWidth:o}),s=p.useRef(null),r=p.useRef();return{containerRef:p.useCallback(c=>{var i;(i=r.current)==null||i.disconnect(),r.current=void 0,s.current=c;const l=()=>n({newContainerWidth:xt(s.current,t),newScrollbarWidth:window.innerWidth-document.documentElement.clientWidth});l(),c&&typeof ResizeObserver<"u"&&(r.current=new ResizeObserver(l),r.current.observe(c))},[t]),containerWidth:e}}const Rt=Object.freeze([1200,600,300,0]);function j(t,o){return typeof t=="function"?t(o):t}function F(t,o){return typeof t<"u"?j(t,o):void 0}function Mt(t,o){const e=Rt.findIndex(n=>n<=o);return j(t[e>=0?e:0],o)}function x(t,o,e,n=0){const s=F(t,o);return Math.round(Math.max(s===void 0?Mt(e,o):s,n))}function _t({layout:t,onClick:o,containerWidth:e,targetRowHeight:n,rowConstraints:s,columns:r,spacing:a,padding:c,sizes:i}){return{layout:t,onClick:o,containerWidth:e,columns:x(r,e,[5,4,3,2],1),spacing:x(a,e,[20,15,10,5]),padding:x(c,e,[0,0,0,0,0]),targetRowHeight:x(n,e,[l=>l/5,l=>l/4,l=>l/3,l=>l/2]),rowConstraints:F(s,e),sizes:i}}function bt(t,o,e){const{photos:n,componentsProps:s}=t,r=j(s,o)||{};if(e){const{layout:a,spacing:c,padding:i,rowConstraints:l}=e;if(a==="rows"){const{singleRowMaxHeight:u}=l||{};if(u){const m=Math.floor(n.reduce((f,{width:d,height:h})=>f+d/h*u-2*i,i*n.length*2+c*(n.length-1)));m>0&&(r.containerProps=r.containerProps||{},r.containerProps.style={maxWidth:m,...r.containerProps.style})}}}return r}function kt(t,o,e){const{photos:n,layout:s,renderPhoto:r,renderRowContainer:a,renderColumnContainer:c}=t,i={photos:n,renderPhoto:r,componentsProps:o};return s==="rows"?p.createElement(ct,{layoutOptions:e,renderRowContainer:a,...i}):s==="columns"?p.createElement(pt,{layoutOptions:e,renderColumnContainer:c,...i}):p.createElement(gt,{layoutOptions:e,renderColumnContainer:c,...i})}function Et(t){const{photos:o,layout:e,renderContainer:n,defaultContainerWidth:s,breakpoints:r}=t,{containerRef:a,containerWidth:c}=Pt(Ct(r),s);if(!e||!["rows","columns","masonry"].includes(e)||!Array.isArray(o))return null;const i=c?_t({containerWidth:c,...t}):void 0,l=bt(t,c,i);return p.createElement(wt,{layout:e,containerRef:a,renderContainer:n,containerProps:l.containerProps},i&&kt(t,l,i))}const $t=t=>p.createElement("svg",{fill:"#ffffff",width:"800px",height:"800px",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",...t},p.createElement("path",{fillRule:"evenodd",d:"M12,2 C17.5228475,2 22,6.4771525 22,12 C22,17.5228475 17.5228475,22 12,22 C6.4771525,22 2,17.5228475 2,12 C2,6.4771525 6.4771525,2 12,2 Z M12,4 C7.581722,4 4,7.581722 4,12 C4,16.418278 7.581722,20 12,20 C16.418278,20 20,16.418278 20,12 C20,7.581722 16.418278,4 12,4 Z M10.503871,7.1362211 L16.503871,11.1362211 C17.1264642,11.4994005 17.1630874,12.3674256 16.6137404,12.7899986 L10.503871,16.8637789 C9.83721439,17.2526619 9,16.7717908 9,16 L9,8 C9,7.22820917 9.83721439,6.74733806 10.503871,7.1362211 Z"})),Lt=p.memo(function(){const{t:o}=Z(["home"]),e=O(),{city:n,travelIdx:s}=G(),[r]=H(),a=r.get("from"),c=p.useMemo(()=>n.travels[s].photos.map((i,l)=>({src:i.thumbnail,width:i.width,height:i.height,youtube:i.youtube,index:l})),[n,s]);return w.jsxs("div",{className:"gallery",children:[w.jsxs("div",{className:"gallery__header",children:[w.jsx("h2",{children:n.getName(o)}),w.jsx(B,{className:"gallery__header__flag",countryId:n.country.id}),w.jsx(D,{cityName:n.name,selectedTravelIdx:s,travels:n.travels}),w.jsx(T,{onClick:()=>e(a==="map"?"/":"/?to=visited")})]}),w.jsxs("div",{className:"gallery__content",children:[w.jsx("div",{className:"gallery__content__photo-album",id:"info-tab",children:w.jsx(Et,{layout:"rows",onClick:({index:i})=>e(`./${i}`),photos:c,renderPhoto:({photo:i,wrapperStyle:l,renderDefaultPhoto:u})=>w.jsxs("div",{className:"gallery__content__image",style:l,children:[i.youtube?w.jsxs(w.Fragment,{children:[w.jsx($t,{className:"gallery__content__image__play",onClick:()=>e(`./${i.index}`)}),w.jsx("div",{className:"gallery__content__image__gradient",onClick:()=>e(`./${i.index}`)})]}):null,u({wrapped:!0})]})})}),w.jsx(V,{})]})]})});export{Lt as default};
