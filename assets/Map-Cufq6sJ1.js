import{d as V,j as o,r as C,v as U}from"./vendor-BcpBRJU8.js";import{u as Y,M as J,a as Q,Z as X,G as ee,b as te}from"./map-QFWzaBwh.js";import{u as oe,B as se,H as ae,L as ne}from"./index-D6Cz-asS.js";import{_ as le,q,r as ie,t as re,$ as ce,a0 as me}from"./icons-iLYM2YVW.js";import{p as B}from"./parameters-nmkvrbLz.js";import{C as de}from"./CountryFlag-COhmRgvj.js";import{b as pe,v as ue,f as _e,l as fe}from"./data-80xIROWi.js";import{f as he}from"./date-B7ZWhvxN.js";import{a as ve}from"./router-JuuIkx1m.js";import"./gallery-CVePIdsH.js";function R(_){const e=V.c(16),{city:t,hoveredCity:n,setHoveredCity:a,baseZoom:i,defaultScale:h,minScale:r,maxScale:c,isFuture:m,isLived:l}=_,S=i===void 0?B.map.defaultZoom:i,f=h===void 0?B.map.marker.defaultScale:h;let g=r===void 0?B.map.marker.minScale:r,s=c===void 0?B.map.marker.maxScale:c;const M=m===void 0?!1:m,L=l===void 0?!1:l,{k:b}=Y(),k=f*(S/b);g=t.country.minMarkerScale||g,s=t.country.maxMarkerScale||s;const j=Math.min(Math.max(k,g),s),N=n?.name===t.name,H=t.name+"-marker";let d;e[0]!==t||e[1]!==a?(d=()=>a&&a(t),e[0]=t,e[1]=a,e[2]=d):d=e[2];let p;e[3]!==a?(p=()=>a&&a(null),e[3]=a,e[4]=p):p=e[4];let v;e[5]===Symbol.for("react.memo_cache_sentinel")?(v={default:{outline:"none"},hover:{outline:"none"},pressed:{outline:"none"}},e[5]=v):v=e[5];const y=`${N?"marker-icon--hovered":""}
          ${M?"marker-icon--future":""}
          ${L?"marker-icon--lived":""}
        `;let u;e[6]!==j||e[7]!==y?(u=o.jsx(le,{className:y,scale:j}),e[6]=j,e[7]=y,e[8]=u):u=e[8];let x;return e[9]!==t.coordinates||e[10]!==t.name||e[11]!==u||e[12]!==H||e[13]!==d||e[14]!==p?(x=o.jsx(J,{coordinates:t.coordinates,id:H,onMouseEnter:d,onMouseLeave:p,style:v,children:u},t.name),e[9]=t.coordinates,e[10]=t.name,e[11]=u,e[12]=H,e[13]=d,e[14]=p,e[15]=x):x=e[15],x}function xe(_){const e=V.c(57),{city:t,onMouseEnter:n,onMouseLeave:a,setIsOpen:i}=_,h=ve();let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=["home"],e[0]=r):r=e[0];const{t:c,currLanguage:m}=oe(r),[l,S]=C.useState(0),f=t.travels.filter(ge);let g;e[1]!==t||e[2]!==n||e[3]!==a?(g=z=>o.jsx("div",{className:`map-tooltip__backdrop ${z}`,onMouseEnter:()=>n&&n(t),onMouseLeave:()=>a&&a()}),e[1]=t,e[2]=n,e[3]=a,e[4]=g):g=e[4];const s=g;let M,L;e[5]!==i?(M=()=>{const z=()=>document.hidden&&i(!1);return document.addEventListener("visibilitychange",z),()=>{document.removeEventListener("visibilitychange",z)}},L=[i],e[5]=i,e[6]=M,e[7]=L):(M=e[6],L=e[7]),C.useEffect(M,L);let b,k,j,N;e[8]!==s?(b=s("map-tooltip__backdrop--top"),k=s("map-tooltip__backdrop--right"),j=s("map-tooltip__backdrop--bottom"),N=s("map-tooltip__backdrop--left"),e[8]=s,e[9]=b,e[10]=k,e[11]=j,e[12]=N):(b=e[9],k=e[10],j=e[11],N=e[12]);const H="map-tooltip__container";let d;e[13]!==t||e[14]!==n?(d=()=>n&&n(t),e[13]=t,e[14]=n,e[15]=d):d=e[15];let p;e[16]!==a?(p=()=>a&&a(),e[16]=a,e[17]=p):p=e[17];let v;e[18]!==t||e[19]!==c?(v=t.getName(c),e[18]=t,e[19]=c,e[20]=v):v=e[20];let y;e[21]!==v?(y=o.jsx("h2",{children:v}),e[21]=v,e[22]=y):y=e[22];let u;e[23]!==t.country.id?(u=o.jsx(de,{countryId:t.country.id}),e[23]=t.country.id,e[24]=u):u=e[24];let x;e[25]!==y||e[26]!==u?(x=o.jsxs("div",{className:"map-tooltip__header",children:[y,u]}),e[25]=y,e[26]=u,e[27]=x):x=e[27];let A;e[28]===Symbol.for("react.memo_cache_sentinel")?(A=o.jsx(ce,{className:"map-tooltip__metadata__icon"}),e[28]=A):A=e[28];let $;e[29]!==t.population||e[30]!==m?($=t.population?t.population.toLocaleString(m):"-",e[29]=t.population,e[30]=m,e[31]=$):$=e[31];let E;e[32]!==$?(E=o.jsxs("div",{className:"map-tooltip__metadata__item",children:[A,$]}),e[32]=$,e[33]=E):E=e[33];let G;e[34]===Symbol.for("react.memo_cache_sentinel")?(G=o.jsx(me,{className:"map-tooltip__metadata__icon"}),e[34]=G):G=e[34];const P=c(`currency.${t.country.currency}.name`);let w;e[35]!==P?(w=o.jsx("p",{className:"currency-row__name",children:P}),e[35]=P,e[36]=w):w=e[36];const W=" "+c(`currency.${t.country.currency}.symbol`);let F;e[37]!==W?(F=o.jsx("b",{className:"currency-row__symbol",children:W}),e[37]=W,e[38]=F):F=e[38];let Z;e[39]!==w||e[40]!==F?(Z=o.jsxs("div",{className:"map-tooltip__metadata__item",children:[G,w,F]}),e[39]=w,e[40]=F,e[41]=Z):Z=e[41];let I;e[42]!==E||e[43]!==Z?(I=o.jsxs("div",{className:"map-tooltip__metadata",children:[E,Z]}),e[42]=E,e[43]=Z,e[44]=I):I=e[44];const O=f[l]?o.jsxs("div",{className:"map-tooltip__divider",children:[o.jsx("div",{className:"map-tooltip__content",children:o.jsxs("div",{className:"map-tooltip__content__travels",children:[o.jsxs("b",{className:"map-tooltip__content__travels__title",children:[c("selectedTravel")," ",l+1," /"," ",f.length]}),o.jsxs("div",{className:"map-tooltip__content__travels__selector",children:[o.jsx(q,{className:`map-tooltip__content__chevron-icon map-tooltip__content__chevron-icon--left ${l>0?"":"map-tooltip__content__chevron-icon--disabled"}`,onClick:()=>l>0&&S(l-1)}),o.jsxs("div",{className:"map-tooltip__content__travel",children:[o.jsx(ie,{className:"map-tooltip__content__travel__icon"}),o.jsx("p",{children:he({sDateInput:f[l].sDate,eDateInput:f[l].eDate,locale:m,includeWeekday:!0,showYear:!0})})]}),o.jsx(q,{className:`map-tooltip__content__chevron-icon ${l<f.length-1?"":"map-tooltip__content__chevron-icon--disabled"}`,onClick:()=>l<f.length-1&&S(l+1)})]})]})}),f[l].photos&&f[l].photos.length>0?o.jsx("div",{className:"map-tooltip__footer",children:o.jsxs(se,{className:"map-tooltip__footer__button",onClick:()=>h(`/gallery/${t.name}/${l}?from=map`),children:[o.jsx(re,{}),o.jsx("p",{children:c("galleryAlt")})]})}):null]}):null;let D;e[45]!==d||e[46]!==p||e[47]!==x||e[48]!==I||e[49]!==O?(D=o.jsxs("div",{className:H,onMouseEnter:d,onMouseLeave:p,children:[x,I,O]}),e[45]=d,e[46]=p,e[47]=x,e[48]=I,e[49]=O,e[50]=D):D=e[50];let T;return e[51]!==D||e[52]!==b||e[53]!==k||e[54]!==j||e[55]!==N?(T=o.jsxs(o.Fragment,{children:[b,k,j,N,D]}),e[51]=D,e[52]=b,e[53]=k,e[54]=j,e[55]=N,e[56]=T):T=e[56],T}function ge(_){return!_.isFuture}const je="/assets/countries-50m-BgWjA-HH.json",K=(_,e)=>{const t=_.coordinates[0],n=e.coordinates[0],a=_.coordinates[1],i=e.coordinates[1];return a<i?1:a>i||t<n?-1:t>n?1:0};function ye(_){const e=V.c(11),{geographies:t,getCountryFillColor:n,onLoaded:a}=_;let i,h;e[0]!==t.length||e[1]!==a?(i=()=>{t.length>0&&a()},h=[t.length,a],e[0]=t.length,e[1]=a,e[2]=i,e[3]=h):(i=e[2],h=e[3]),C.useEffect(i,h);let r;if(e[4]!==t||e[5]!==n){let m;e[7]!==n?(m=l=>o.jsx(te,{fill:n(l.properties.name),geography:l,strokeWidth:0,style:{default:{outline:"none"},hover:{outline:"none"},pressed:{outline:"none"}}},l.rsmKey),e[7]=n,e[8]=m):m=e[8],r=t.map(m),e[4]=t,e[5]=n,e[6]=r}else r=e[6];let c;return e[9]!==r?(c=o.jsx(o.Fragment,{children:r}),e[9]=r,e[10]=c):c=e[10],c}function Fe(){const _=C.useContext(ae),{isDarkTheme:e,hoveredCity:t,setHoveredCity:n,mapPosition:a,responsive:i,setMapPosition:h}=_,[r,c]=C.useState(!1),m=C.useMemo(()=>new globalThis.Map(pe.map(s=>[s.id,s.fillColor])),[]),l=C.useCallback(s=>{const M=m.get(s);return M||(e?"#1a1a1a":"#dadada")},[e,m]),S=C.useMemo(()=>[...ue].sort(K),[]),f=C.useMemo(()=>[..._e].sort(K),[]),g=C.useCallback(()=>{c(!0)},[]);return o.jsxs("div",{className:"map-container",style:{...i.window},children:[r?null:o.jsx("div",{className:"loading",style:{...i.window},children:o.jsx(ne,{})}),o.jsx(Q,{className:"map","data-tip":"",projection:"geoMercator",projectionConfig:{scale:160},...i.window,children:o.jsxs(X,{center:a.center,maxZoom:B.map.defaultMaxZoom,minZoom:B.map.defaultMinZoom,onMoveEnd:s=>h({center:s.coordinates,zoom:s.zoom}),zoom:a.zoom,children:[o.jsx(ee,{geography:je,children:({geographies:s})=>s.length>0?o.jsx(ye,{geographies:s,getCountryFillColor:l,onLoaded:g}):null}),r?S.map(s=>o.jsx(R,{city:s,hoveredCity:t,setHoveredCity:n},s.name)):null,r?f.map(s=>o.jsx(R,{city:s,hoveredCity:t,isFuture:!0,setHoveredCity:n},s.name)):null,r?fe.map(s=>o.jsx(R,{city:s,hoveredCity:t,isLived:!0,setHoveredCity:n},s.name)):null]})}),o.jsx(U,{anchorSelect:`#${t?.name}-marker`,clickable:!0,id:"map-tooltip",isOpen:t!==null,noArrow:!0,opacity:1,variant:"light",children:t?o.jsx(xe,{city:t,onMouseEnter:s=>n(s),onMouseLeave:()=>n(null),setIsOpen:s=>n(s?t:null)}):null})]})}export{Fe as default};
