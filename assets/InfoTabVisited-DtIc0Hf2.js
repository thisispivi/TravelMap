import{r as e,l as t,w as a,x as s,j as i,y as r,A as n,z as c,d as o,D as l}from"./vendor-DKZVa1wl.js";import{u as d,B as m,L as p,H as _}from"./index-VkpMRTUv.js";import{c as u}from"./data-BmJ8MHyF.js";import{p as h,c as f}from"./parameters-DaZPJ3Fv.js";import{P as x}from"./PositionButton-ZBLZd_4Q.js";import"./map-BRUXIl5C.js";import{f as y}from"./date-CfYOor-m.js";import{w as j,r as v}from"./icons-C71SayX9.js";import{C as g}from"./CountryFlag-BvMsS2nw.js";import{R as N}from"./Row-WbRBCMjT.js";import"./gallery-DOdM-sjS.js";function b({className:o="",trip:l,setHoveredCity:_,setMapPosition:u,isAutoPosition:f=!1}){const[x,b]=e.useState(!1),I=t(),{t:D,currLanguage:C}=d(["home"]),P=a(),w=e.useId(),Y=e.useMemo(()=>s(l.destinations.map(e=>e.city.country),e=>e.id),[l.destinations]);return i.jsxs(r.article,{className:`trip-card ${o}`,layout:!0,transition:P?{duration:0}:{type:"spring",stiffness:520,damping:46},children:[i.jsxs("button",{"aria-controls":w,"aria-expanded":x,className:"trip-card__header",onClick:e=>{e.stopPropagation(),b(e=>!e)},type:"button",children:[i.jsxs("div",{"aria-hidden":!0,className:"trip-card__image-container",children:[i.jsx("div",{className:"trip-card__image-overlay"}),i.jsx("img",{alt:l.name,className:"trip-card__image",src:l.backgroundImgSource})]}),i.jsxs("div",{className:"trip-card__info",children:[i.jsx(N,{className:"trip-card__flags",children:Y.map(e=>i.jsx(g,{className:"trip-card__flag",countryId:e.id},e.id))}),i.jsxs("div",{className:"trip-card__header-row",children:[i.jsx("h2",{className:"trip-card__title",children:l.name}),i.jsx(r.span,{animate:{rotate:x?90:-90},"aria-hidden":!0,className:"trip-card__chevron",transition:P?{duration:0}:{type:"spring",stiffness:700,damping:44},children:i.jsx(j,{className:"trip-card__chevron-icon"})})]}),l.sDate?i.jsxs("div",{className:"trip-card__date",children:[i.jsx(v,{className:"trip-card__date-icon"}),i.jsx("p",{className:"trip-card__date-text",children:y({sDateInput:l.sDate,eDateInput:l.eDate,locale:C,includeWeekday:!1,showYear:!0})})]}):null]})]}),i.jsx(n,{initial:!1,children:x?i.jsx(r.section,{animate:{height:"auto",opacity:1},className:"trip-card__details",exit:{height:0,opacity:0},id:w,initial:!P&&{height:0,opacity:0},transition:P?{duration:0}:{duration:.32,ease:[.2,.8,.2,1]},children:i.jsx("div",{className:"trip-card__details-inner",children:i.jsx("div",{className:"trip-card__cities",children:l.destinations.map((e,t)=>i.jsxs(m,{ariaLabel:`Open ${e.city.getName(D)} gallery`,className:"trip-card__city",onClick:t=>{t.stopPropagation(),I(`/gallery/${e.city.name}/${e.travelIdx}`)},onMouseEnter:()=>{_(e.city),u&&e.city.mapCoordinates&&f&&u({center:e.city.mapCoordinates,zoom:h.map.hoveredCityZoom})},onMouseLeave:()=>_(null),children:[i.jsx("div",{className:"trip-card__city-number",children:t+1}),i.jsxs("div",{className:"trip-card__city-body",children:[i.jsxs("div",{className:"trip-card__city-topline",children:[i.jsx("p",{className:"trip-card__city-name",children:e.city.getName(D)}),i.jsx(g,{className:"trip-card__city-flag",countryId:e.city.country.id})]}),e.city.travels[e.travelIdx]?.sDate?i.jsxs("div",{className:"trip-card__city-dates",children:[i.jsx(v,{className:"trip-card__city-dates-icon"}),i.jsx("p",{className:"trip-card__city-dates-text",children:y({sDateInput:e.city.travels[e.travelIdx].sDate,eDateInput:e.city.travels[e.travelIdx].eDate,locale:C,includeWeekday:!1,showYear:!0})})]}):null]}),i.jsx("div",{"aria-hidden":!0,className:"trip-card__city-image-container",children:i.jsx(c.LazyLoadImage,{alt:e.city.getName(D),className:"trip-card__city-image",effect:"opacity",placeholder:i.jsx("div",{className:"trip-card__city-loading",children:i.jsx(p,{})}),src:e.city.getBackgroundImgSourceByIndex(0)||void 0})})]},`${e.city.name}-${e.travelIdx}`))})})}):null})]})}function I(t){const a=o.c(41),{trips:s,className:r,id:n,isVisible:c}=t,l=void 0===r?"":r,m=void 0!==c&&c;let p;a[0]===Symbol.for("react.memo_cache_sentinel")?(p=["home"],a[0]=p):p=a[0];const{t:u}=d(p),{isAutoPosition:h,setIsAutoPosition:y,responsive:j,setHoveredCity:v,setMapPosition:g}=e.useContext(_),[N,I]=e.useState(f.GROUP_BY_CITIES_DEFAULT_OPENED_YEAR);let C;a[1]===Symbol.for("react.memo_cache_sentinel")?(C=e=>{I(t=>t!==e?e:t)},a[1]=C):C=a[1];const P=C,[w,Y]=e.useState(!1),$=e.useRef(null);let E;a[2]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{if($.current){const e=$.current;Y(e.scrollHeight>e.clientHeight)}},a[2]=E):E=a[2];const A=E;let S,L,R,F,M;a[3]!==m?(S=()=>{if(!m)return;const e=()=>A();return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},L=[A,m],a[3]=m,a[4]=S,a[5]=L):(S=a[4],L=a[5]),e.useEffect(S,L),a[6]!==m?(R=()=>{m&&A()},a[6]=m,a[7]=R):R=a[7],a[8]!==m||a[9]!==N||a[10]!==s?(F=[A,s,N,m],a[8]=m,a[9]=N,a[10]=s,a[11]=F):F=a[11],e.useEffect(R,F),a[12]!==s?(M=function(e,{cutoffYear:t}){const a={};for(const s of e){const e=new Date(s.sDate).getFullYear(),i=new Date(s.eDate??s.sDate).getFullYear(),r=Math.min(e,i),n=Math.max(e,i);for(let c=r;c<=n;c++){const e=c<=t?t:c;let i=a[e];i||(i=a[e]=[]),i.push(s)}}return a}(s,{cutoffYear:f.GROUP_BY_CITIES_CUTOFF_YEAR}),a[12]=s,a[13]=M):M=a[13];const k=M;let O;a[14]!==h||a[15]!==v||a[16]!==g?(O=e=>i.jsx(i.Fragment,{children:e.map(e=>i.jsx(b,{isAutoPosition:h,setHoveredCity:v,setMapPosition:g,trip:e},e.id))}),a[14]=h,a[15]=v,a[16]=g,a[17]=O):O=a[17];const B=O;if(!m)return null;let H;a[18]!==k||a[19]!==w||a[20]!==n||a[21]!==B||a[22]!==N?(H=i.jsx(D,{contentRef:$,groups:k,hasOverflow:w,id:n,renderTripCards:B,selectedYear:N,toggleYear:P}),a[18]=k,a[19]=w,a[20]=n,a[21]=B,a[22]=N,a[23]=H):H=a[23];const T=H,z=`info-tab-trips info-tab-${n} ${l} ${m?"info-tab-trips--visible":""}`,U=`info-tab-trips__header info-tab-${n}__header`,V=n+".title";let G,W,Z,q,J;return a[24]!==u||a[25]!==V?(G=u(V),a[24]=u,a[25]=V,a[26]=G):G=a[26],a[27]!==G?(W=i.jsx("h1",{children:G}),a[27]=G,a[28]=W):W=a[28],a[29]!==h||a[30]!==j||a[31]!==y?(Z=i.jsx("div",{className:"info-tab-trips__header__buttons",children:i.jsx(x,{isAutoPosition:h,responsive:j,setIsAutoPosition:y})}),a[29]=h,a[30]=j,a[31]=y,a[32]=Z):Z=a[32],a[33]!==U||a[34]!==W||a[35]!==Z?(q=i.jsxs("div",{className:U,children:[W,Z]}),a[33]=U,a[34]=W,a[35]=Z,a[36]=q):q=a[36],a[37]!==T||a[38]!==z||a[39]!==q?(J=i.jsxs("div",{className:z,children:[q,T]}),a[37]=T,a[38]=z,a[39]=q,a[40]=J):J=a[40],J}function D(e){const t=o.c(23),{groups:a,selectedYear:s,toggleYear:r,renderTripCards:n,id:c,hasOverflow:d,contentRef:m}=e;let p,_;if(t[0]!==a||t[1]!==s||t[2]!==r){let e;t[4]!==s||t[5]!==r?(e=(e,t)=>i.jsx("button",{className:"info-tab-trips__year__button "+(s===parseInt(e)?"info-tab-trips__year__button--active":""),onClick:()=>r(parseInt(e)),type:"button",children:`${0===t?"â‰¤ ":""}${e}`},e),t[4]=s,t[5]=r,t[6]=e):e=t[6],p=l(a).map(e),t[0]=a,t[1]=s,t[2]=r,t[3]=p}else p=t[3];t[7]!==p?(_=i.jsx("div",{className:"info-tab-trips__header info-tab-trips__year__selector",children:p}),t[7]=p,t[8]=_):_=t[8];const u="info-tab-trips__content--grouped "+(d?"info-tab-trips__content--overflow":"");let h,f,x;if(t[9]!==a||t[10]!==c||t[11]!==n||t[12]!==s){let e;t[14]!==s?(e=e=>s===parseInt(e),t[14]=s,t[15]=e):e=t[15],h=l(a).filter(e).map(e=>i.jsx("div",{className:"info-tab-trips__year-group",children:s===parseInt(e)?i.jsx("div",{className:`info-tab-trips__content info-tab-${c}__content`,children:n(a[e])}):null},e)),t[9]=a,t[10]=c,t[11]=n,t[12]=s,t[13]=h}else h=t[13];return t[16]!==m||t[17]!==u||t[18]!==h?(f=i.jsx("div",{className:u,id:"info-tab",ref:m,children:h}),t[16]=m,t[17]=u,t[18]=h,t[19]=f):f=t[19],t[20]!==_||t[21]!==f?(x=i.jsxs(i.Fragment,{children:[_,f]}),t[20]=_,t[21]=f,t[22]=x):x=t[22],x}function C(e){const t=o.c(3),{className:a,isVisible:s}=e,r=void 0===a?"":a,n=void 0!==s&&s;let c;return t[0]!==r||t[1]!==n?(c=i.jsx(I,{className:r,id:"visited",isVisible:n,trips:u}),t[0]=r,t[1]=n,t[2]=c):c=t[2],c}export{C as InfoTabVisited};
