import{d as e,j as o,s as t,r as n,M as a}from"./vendor-CJygW6li.js";import{u as s,M as r,a as l,Z as i,G as c,b as m}from"./map-Cd4XNAeV.js";import{u as d,B as p,H as _,L as u}from"./index-DGHe59nE.js";import{M as h,q as v,r as j,t as x,x as y,y as f}from"./icons-9ZlXhvAm.js";import{p as g}from"./parameters-AtdN-mRF.js";import{C as N}from"./CountryFlag-DjWk0q22.js";import{f as b}from"./date-6TXu5sa-.js";import{a as k,v as M,f as S,l as C}from"./data-Di2FxgI_.js";import"./gallery-_k83rUEI.js";function L(t){const n=e.c(16),{city:a,hoveredCity:l,setHoveredCity:i,baseZoom:c,defaultScale:m,minScale:d,maxScale:p,isFuture:_,isLived:u}=t,v=void 0===c?g.map.defaultZoom:c,j=void 0===m?g.map.marker.defaultScale:m;let x=void 0===d?g.map.marker.minScale:d,y=void 0===p?g.map.marker.maxScale:p;const f=void 0!==_&&_,N=void 0!==u&&u,{k:b}=s(),k=j*(v/b);x=a.country.minMarkerScale||x,y=a.country.maxMarkerScale||y;const M=Math.min(Math.max(k,x),y),S=l?.name===a.name,C=a.name+"-marker";let L,E,w;n[0]!==a||n[1]!==i?(L=()=>i&&i(a),n[0]=a,n[1]=i,n[2]=L):L=n[2],n[3]!==i?(E=()=>i&&i(null),n[3]=i,n[4]=E):E=n[4],n[5]===Symbol.for("react.memo_cache_sentinel")?(w={default:{outline:"none"},hover:{outline:"none"},pressed:{outline:"none"}},n[5]=w):w=n[5];const $=`${S?"marker-icon--hovered":""}\n          ${f?"marker-icon--future":""}\n          ${N?"marker-icon--lived":""}\n        `;let F,Z;return n[6]!==M||n[7]!==$?(F=o.jsx(h,{className:$,scale:M}),n[6]=M,n[7]=$,n[8]=F):F=n[8],n[9]!==a.coordinates||n[10]!==a.name||n[11]!==F||n[12]!==C||n[13]!==L||n[14]!==E?(Z=o.jsx(r,{coordinates:a.coordinates,id:C,onMouseEnter:L,onMouseLeave:E,style:w,children:F},a.name),n[9]=a.coordinates,n[10]=a.name,n[11]=F,n[12]=C,n[13]=L,n[14]=E,n[15]=Z):Z=n[15],Z}function E(a){const s=e.c(57),{city:r,onMouseEnter:l,onMouseLeave:i,setIsOpen:c}=a,m=t();let _;s[0]===Symbol.for("react.memo_cache_sentinel")?(_=["home"],s[0]=_):_=s[0];const{t:u,currLanguage:h}=d(_),[g,k]=n.useState(0),M=r.travels.filter(w);let S;s[1]!==r||s[2]!==l||s[3]!==i?(S=e=>o.jsx("div",{className:`map-tooltip__backdrop ${e}`,onMouseEnter:()=>l&&l(r),onMouseLeave:()=>i&&i()}),s[1]=r,s[2]=l,s[3]=i,s[4]=S):S=s[4];const C=S;let L,E,$,F,Z,z;s[5]!==c?(L=()=>{const e=()=>document.hidden&&c(!1);return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},E=[c],s[5]=c,s[6]=L,s[7]=E):(L=s[6],E=s[7]),n.useEffect(L,E),s[8]!==C?($=C("map-tooltip__backdrop--top"),F=C("map-tooltip__backdrop--right"),Z=C("map-tooltip__backdrop--bottom"),z=C("map-tooltip__backdrop--left"),s[8]=C,s[9]=$,s[10]=F,s[11]=Z,s[12]=z):($=s[9],F=s[10],Z=s[11],z=s[12]);let H,D,I,O,A,W,B,P,T,q;s[13]!==r||s[14]!==l?(H=()=>l&&l(r),s[13]=r,s[14]=l,s[15]=H):H=s[15],s[16]!==i?(D=()=>i&&i(),s[16]=i,s[17]=D):D=s[17],s[18]!==r||s[19]!==u?(I=r.getName(u),s[18]=r,s[19]=u,s[20]=I):I=s[20],s[21]!==I?(O=o.jsx("h2",{children:I}),s[21]=I,s[22]=O):O=s[22],s[23]!==r.country.id?(A=o.jsx(N,{countryId:r.country.id}),s[23]=r.country.id,s[24]=A):A=s[24],s[25]!==O||s[26]!==A?(W=o.jsxs("div",{className:"map-tooltip__header",children:[O,A]}),s[25]=O,s[26]=A,s[27]=W):W=s[27],s[28]===Symbol.for("react.memo_cache_sentinel")?(B=o.jsx(y,{className:"map-tooltip__metadata__icon"}),s[28]=B):B=s[28],s[29]!==r.population||s[30]!==h?(P=r.population?r.population.toLocaleString(h):"-",s[29]=r.population,s[30]=h,s[31]=P):P=s[31],s[32]!==P?(T=o.jsxs("div",{className:"map-tooltip__metadata__item",children:[B,P]}),s[32]=P,s[33]=T):T=s[33],s[34]===Symbol.for("react.memo_cache_sentinel")?(q=o.jsx(f,{className:"map-tooltip__metadata__icon"}),s[34]=q):q=s[34];const G=u(`currency.${r.country.currency}.name`);let K;s[35]!==G?(K=o.jsx("p",{className:"currency-row__name",children:G}),s[35]=G,s[36]=K):K=s[36];const R=" "+u(`currency.${r.country.currency}.symbol`);let Y,J,Q;s[37]!==R?(Y=o.jsx("b",{className:"currency-row__symbol",children:R}),s[37]=R,s[38]=Y):Y=s[38],s[39]!==K||s[40]!==Y?(J=o.jsxs("div",{className:"map-tooltip__metadata__item",children:[q,K,Y]}),s[39]=K,s[40]=Y,s[41]=J):J=s[41],s[42]!==T||s[43]!==J?(Q=o.jsxs("div",{className:"map-tooltip__metadata",children:[T,J]}),s[42]=T,s[43]=J,s[44]=Q):Q=s[44];const U=M[g]?o.jsxs("div",{className:"map-tooltip__divider",children:[o.jsx("div",{className:"map-tooltip__content",children:o.jsxs("div",{className:"map-tooltip__content__travels",children:[o.jsxs("b",{className:"map-tooltip__content__travels__title",children:[u("selectedTravel")," ",g+1," /"," ",M.length]}),o.jsxs("div",{className:"map-tooltip__content__travels__selector",children:[o.jsx(v,{className:"map-tooltip__content__chevron-icon map-tooltip__content__chevron-icon--left "+(g>0?"":"map-tooltip__content__chevron-icon--disabled"),onClick:()=>g>0&&k(g-1)}),o.jsxs("div",{className:"map-tooltip__content__travel",children:[o.jsx(j,{className:"map-tooltip__content__travel__icon"}),o.jsx("p",{children:b({sDateInput:M[g].sDate,eDateInput:M[g].eDate,locale:h,includeWeekday:!0,showYear:!0})})]}),o.jsx(v,{className:"map-tooltip__content__chevron-icon "+(g<M.length-1?"":"map-tooltip__content__chevron-icon--disabled"),onClick:()=>g<M.length-1&&k(g+1)})]})]})}),M[g].photos&&M[g].photos.length>0?o.jsx("div",{className:"map-tooltip__footer",children:o.jsxs(p,{className:"map-tooltip__footer__button",onClick:()=>m(`/gallery/${r.name}/${g}?from=map`),children:[o.jsx(x,{}),o.jsx("p",{children:u("galleryAlt")})]})}):null]}):null;let V,X;return s[45]!==H||s[46]!==D||s[47]!==W||s[48]!==Q||s[49]!==U?(V=o.jsxs("div",{className:"map-tooltip__container",onMouseEnter:H,onMouseLeave:D,children:[W,Q,U]}),s[45]=H,s[46]=D,s[47]=W,s[48]=Q,s[49]=U,s[50]=V):V=s[50],s[51]!==V||s[52]!==$||s[53]!==F||s[54]!==Z||s[55]!==z?(X=o.jsxs(o.Fragment,{children:[$,F,Z,z,V]}),s[51]=V,s[52]=$,s[53]=F,s[54]=Z,s[55]=z,s[56]=X):X=s[56],X}function w(e){return!e.isFuture}const $=(e,o)=>{const t=e.coordinates[0],n=o.coordinates[0],a=e.coordinates[1],s=o.coordinates[1];return a<s?1:a>s||t<n?-1:t>n?1:0},F={default:{outline:"none"},hover:{outline:"none"},pressed:{outline:"none"}},Z={scale:160};function z(t){const a=e.c(11),{geographies:s,getCountryFillColor:r,onLoaded:l}=t,i=n.useRef(!1);let c,d,p,_;if(a[0]!==s.length||a[1]!==l?(c=()=>{!i.current&&s.length>0&&(i.current=!0,l())},d=[s.length,l],a[0]=s.length,a[1]=l,a[2]=c,a[3]=d):(c=a[2],d=a[3]),n.useEffect(c,d),a[4]!==s||a[5]!==r){let e;a[7]!==r?(e=e=>o.jsx(m,{fill:r(e.properties.name),geography:e,strokeWidth:0,style:F},e.rsmKey),a[7]=r,a[8]=e):e=a[8],p=s.map(e),a[4]=s,a[5]=r,a[6]=p}else p=a[6];return a[9]!==p?(_=o.jsx(o.Fragment,{children:p}),a[9]=p,a[10]=_):_=a[10],_}function H(){const t=e.c(70),s=n.useContext(_),{isDarkTheme:r,hoveredCity:m,setHoveredCity:d,mapPosition:p,responsive:h,setMapPosition:v}=s,[j,x]=n.useState(!1);let y;t[0]===Symbol.for("react.memo_cache_sentinel")?(y=Object.fromEntries(k.map(D)),t[0]=y):y=t[0];const f=y;let N;t[1]!==r?(N=e=>f[e]??(r?"#1a1a1a":"#dadada"),t[1]=r,t[2]=N):N=t[2];const b=N;let w,F,H,I,O,A,W,B,P,T,q,G,K,R,Y,J,Q,U,V,X;if(t[3]!==b||t[4]!==m||t[5]!==j||t[6]!==p.center||t[7]!==p.zoom||t[8]!==h.window||t[9]!==d||t[10]!==v){const e=[...M].sort($),n=[...S].sort($),a=[...C].sort($);let s;t[29]===Symbol.for("react.memo_cache_sentinel")?(s=()=>{x(!0)},t[29]=s):s=t[29];const r=s;let _;t[30]!==v?(_=e=>{v({center:e.coordinates,zoom:e.zoom})},t[30]=v,t[31]=_):_=t[31];const y=_;let f;t[32]!==m||t[33]!==d?(f=(e,t)=>e.map(e=>o.jsx(L,{city:e,hoveredCity:m,setHoveredCity:d,...t},e.name)),t[32]=m,t[33]=d,t[34]=f):f=t[34];const N=f;let k;k=m?`#${CSS.escape(`${m.name}-marker`)}`:"",U=k;const E=h.window;W="map-container",B=E,t[35]!==j||t[36]!==E?(P=j?null:o.jsx("div",{className:"loading",style:E,children:o.jsx(u,{})}),t[35]=j,t[36]=E,t[37]=P):P=t[37],F=l,Q="map",H="",I="geoMercator",O=Z,A=E,w=i,T=p.center,q=g.map.defaultMaxZoom,G=g.map.defaultMinZoom,K=y,R=p.zoom,t[38]!==b?(Y=o.jsx(c,{geography:"/assets/countries-50m-BgWjA-HH.json",children:e=>{const{geographies:t}=e;return t.length>0?o.jsx(z,{geographies:t,getCountryFillColor:b,onLoaded:r}):null}}),t[38]=b,t[39]=Y):Y=t[39],J=j?o.jsxs(o.Fragment,{children:[N(e),N(n,{isFuture:!0}),N(a,{isLived:!0})]}):null,t[3]=b,t[4]=m,t[5]=j,t[6]=p.center,t[7]=p.zoom,t[8]=h.window,t[9]=d,t[10]=v,t[11]=w,t[12]=F,t[13]=H,t[14]=I,t[15]=O,t[16]=A,t[17]=W,t[18]=B,t[19]=P,t[20]=T,t[21]=q,t[22]=G,t[23]=K,t[24]=R,t[25]=Y,t[26]=J,t[27]=Q,t[28]=U}else w=t[11],F=t[12],H=t[13],I=t[14],O=t[15],A=t[16],W=t[17],B=t[18],P=t[19],T=t[20],q=t[21],G=t[22],K=t[23],R=t[24],Y=t[25],J=t[26],Q=t[27],U=t[28];t[40]!==w||t[41]!==T||t[42]!==q||t[43]!==G||t[44]!==K||t[45]!==R||t[46]!==Y||t[47]!==J?(V=o.jsxs(w,{center:T,maxZoom:q,minZoom:G,onMoveEnd:K,zoom:R,children:[Y,J]}),t[40]=w,t[41]=T,t[42]=q,t[43]=G,t[44]=K,t[45]=R,t[46]=Y,t[47]=J,t[48]=V):V=t[48],t[49]!==F||t[50]!==H||t[51]!==I||t[52]!==O||t[53]!==A||t[54]!==V||t[55]!==Q?(X=o.jsx(F,{className:Q,"data-tip":H,projection:I,projectionConfig:O,...A,children:V}),t[49]=F,t[50]=H,t[51]=I,t[52]=O,t[53]=A,t[54]=V,t[55]=Q,t[56]=X):X=t[56];const ee=!!m;let oe,te,ne;return t[57]!==m||t[58]!==d?(oe=m?o.jsx(E,{city:m,onMouseEnter:e=>d(e),onMouseLeave:()=>d(null),setIsOpen:e=>d(e?m:null)}):null,t[57]=m,t[58]=d,t[59]=oe):oe=t[59],t[60]!==ee||t[61]!==oe||t[62]!==U?(te=o.jsx(a,{anchorSelect:U,clickable:!0,id:"map-tooltip",isOpen:ee,noArrow:!0,opacity:1,variant:"light",children:oe}),t[60]=ee,t[61]=oe,t[62]=U,t[63]=te):te=t[63],t[64]!==W||t[65]!==B||t[66]!==P||t[67]!==X||t[68]!==te?(ne=o.jsxs("div",{className:W,style:B,children:[P,X,te]}),t[64]=W,t[65]=B,t[66]=P,t[67]=X,t[68]=te,t[69]=ne):ne=t[69],ne}function D(e){return[e.id,e.fillColor]}export{H as Map};
