import{r as v,w as ee,x as te,j as t,y as V,A as se,z as ae,d as U,C as W}from"./vendor-RXEfq5VG.js";import{u as K,B as ie,L as re,H as ce}from"./index-ChRnk8Ci.js";import{b as ne}from"./data-KdNMACQ0.js";import{P as le}from"./PositionButton-XsYMYr-b.js";import{a as oe}from"./map-B9BjKwi7.js";import{p as de,c as G}from"./parameters-C32d5X4B.js";import{w as me,r as Z}from"./icons-DUK9PBCI.js";import{C as q}from"./CountryFlag-CuH2Tpzf.js";import{f as J}from"./date-C2byfksU.js";import{R as pe}from"./Row-Ia4hz3K9.js";import"./gallery-CdeIZUF3.js";function fe({className:g="",trip:e,setHoveredCity:i,setMapPosition:a,isAutoPosition:c=!1}){const[o,p]=v.useState(!1),n=oe(),{t:d,currLanguage:m}=K(["home"]),r=ee(),h=v.useId(),u=v.useMemo(()=>te(e.destinations.map(s=>s.city.country),s=>s.id),[e.destinations]),_=()=>p(s=>!s);return t.jsxs(V.article,{className:`trip-card ${g}`,layout:!0,transition:r?{duration:0}:{type:"spring",stiffness:520,damping:46},children:[t.jsxs("button",{"aria-controls":h,"aria-expanded":o,className:"trip-card__header",onClick:s=>{s.stopPropagation(),_()},type:"button",children:[t.jsxs("div",{"aria-hidden":!0,className:"trip-card__image-container",children:[t.jsx("div",{className:"trip-card__image-overlay"}),t.jsx("img",{alt:e.name,className:"trip-card__image",src:e.backgroundImgSource})]}),t.jsxs("div",{className:"trip-card__info",children:[t.jsx(pe,{className:"trip-card__flags",children:u.map(s=>t.jsx(q,{className:"trip-card__flag",countryId:s.id},s.id))}),t.jsxs("div",{className:"trip-card__header-row",children:[t.jsx("h2",{className:"trip-card__title",children:e.name}),t.jsx(V.span,{animate:{rotate:o?90:-90},"aria-hidden":!0,className:"trip-card__chevron",transition:r?{duration:0}:{type:"spring",stiffness:700,damping:44},children:t.jsx(me,{className:"trip-card__chevron-icon"})})]}),e.sDate?t.jsxs("div",{className:"trip-card__date",children:[t.jsx(Z,{className:"trip-card__date-icon"}),t.jsx("p",{className:"trip-card__date-text",children:J({sDateInput:e.sDate,eDateInput:e.eDate,locale:m,includeWeekday:!1,showYear:!0})})]}):null]})]}),t.jsx(se,{initial:!1,children:o?t.jsx(V.section,{animate:{height:"auto",opacity:1},className:"trip-card__details",exit:{height:0,opacity:0},id:h,initial:r?!1:{height:0,opacity:0},transition:r?{duration:0}:{duration:.32,ease:[.2,.8,.2,1]},children:t.jsx("div",{className:"trip-card__details-inner",children:t.jsx("div",{className:"trip-card__cities",children:e.destinations.map((s,l)=>t.jsxs(ie,{ariaLabel:`Open ${s.city.getName(d)} gallery`,className:"trip-card__city",onClick:f=>{f.stopPropagation(),n(`/gallery/${s.city.name}/${s.travelIdx}`)},onMouseEnter:()=>{i(s.city),a&&s.city.mapCoordinates&&c&&a({center:s.city.mapCoordinates,zoom:de.map.hoveredCityZoom})},onMouseLeave:()=>i(null),children:[t.jsx("div",{className:"trip-card__city-number",children:l+1}),t.jsxs("div",{className:"trip-card__city-body",children:[t.jsxs("div",{className:"trip-card__city-topline",children:[t.jsx("p",{className:"trip-card__city-name",children:s.city.getName(d)}),t.jsx(q,{className:"trip-card__city-flag",countryId:s.city.country.id})]}),s.city.travels[s.travelIdx]?.sDate?t.jsxs("div",{className:"trip-card__city-dates",children:[t.jsx(Z,{className:"trip-card__city-dates-icon"}),t.jsx("p",{className:"trip-card__city-dates-text",children:J({sDateInput:s.city.travels[s.travelIdx].sDate,eDateInput:s.city.travels[s.travelIdx].eDate,locale:m,includeWeekday:!1,showYear:!0})})]}):null]}),t.jsx("div",{"aria-hidden":!0,className:"trip-card__city-image-container",children:t.jsx(ae.LazyLoadImage,{alt:s.city.getName(d),className:"trip-card__city-image",effect:"opacity",placeholder:t.jsx("div",{className:"trip-card__city-loading",children:t.jsx(re,{})}),src:s.city.getBackgroundImgSourceByIndex(0)||void 0})})]},`${s.city.name}-${s.travelIdx}`))})})}):null})]})}function ue(g,{cutoffYear:e}){const i={};for(const a of g){const c=new Date(a.sDate).getFullYear(),o=new Date(a.eDate??a.sDate).getFullYear(),p=Math.min(c,o),n=Math.max(c,o);for(let d=p;d<=n;d++){const m=d<=e?e:d;let r=i[m];r||(r=i[m]=[]),r.push(a)}}return i}function _e(g){const e=U.c(41),{trips:i,className:a,id:c,isVisible:o}=g,p=a===void 0?"":a,n=o===void 0?!1:o;let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d=["home"],e[0]=d):d=e[0];const{t:m}=K(d),{isAutoPosition:r,setIsAutoPosition:h,responsive:u,setHoveredCity:_,setMapPosition:s}=v.useContext(ce),[l,f]=v.useState(G.GROUP_BY_CITIES_DEFAULT_OPENED_YEAR);let y;e[1]===Symbol.for("react.memo_cache_sentinel")?(y=x=>{f(C=>C!==x?x:C)},e[1]=y):y=e[1];const Q=y,[k,X]=v.useState(!1),F=v.useRef(null);let Y;e[2]===Symbol.for("react.memo_cache_sentinel")?(Y=()=>{if(F.current){const x=F.current;X(x.scrollHeight>x.clientHeight)}},e[2]=Y):Y=e[2];const E=Y;let D,$;e[3]!==n?(D=()=>{if(!n)return;const x=()=>E();return window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},$=[E,n],e[3]=n,e[4]=D,e[5]=$):(D=e[4],$=e[5]),v.useEffect(D,$);let w;e[6]!==n?(w=()=>{n&&E()},e[6]=n,e[7]=w):w=e[7];let R;e[8]!==n||e[9]!==l||e[10]!==i?(R=[E,i,l,n],e[8]=n,e[9]=l,e[10]=i,e[11]=R):R=e[11],v.useEffect(w,R);let S;e[12]!==i?(S=ue(i,{cutoffYear:G.GROUP_BY_CITIES_CUTOFF_YEAR}),e[12]=i,e[13]=S):S=e[13];const O=S;let T;e[14]!==r||e[15]!==_||e[16]!==s?(T=x=>t.jsx(t.Fragment,{children:x.map(C=>t.jsx(fe,{isAutoPosition:r,setHoveredCity:_,setMapPosition:s,trip:C},C.id))}),e[14]=r,e[15]=_,e[16]=s,e[17]=T):T=e[17];const B=T;if(!n)return null;let L;e[18]!==O||e[19]!==k||e[20]!==c||e[21]!==B||e[22]!==l?(L=t.jsx(he,{contentRef:F,groups:O,hasOverflow:k,id:c,renderTripCards:B,selectedYear:l,toggleYear:Q}),e[18]=O,e[19]=k,e[20]=c,e[21]=B,e[22]=l,e[23]=L):L=e[23];const A=L,M=`info-tab-trips info-tab-${c} ${p} ${n?"info-tab-trips--visible":""}`,z=`info-tab-trips__header info-tab-${c}__header`,H=c+".title";let j;e[24]!==m||e[25]!==H?(j=m(H),e[24]=m,e[25]=H,e[26]=j):j=e[26];let N;e[27]!==j?(N=t.jsx("h1",{children:j}),e[27]=j,e[28]=N):N=e[28];let b;e[29]!==r||e[30]!==u||e[31]!==h?(b=t.jsx("div",{className:"info-tab-trips__header__buttons",children:t.jsx(le,{isAutoPosition:r,responsive:u,setIsAutoPosition:h})}),e[29]=r,e[30]=u,e[31]=h,e[32]=b):b=e[32];let I;e[33]!==z||e[34]!==N||e[35]!==b?(I=t.jsxs("div",{className:z,children:[N,b]}),e[33]=z,e[34]=N,e[35]=b,e[36]=I):I=e[36];let P;return e[37]!==A||e[38]!==M||e[39]!==I?(P=t.jsxs("div",{className:M,children:[I,A]}),e[37]=A,e[38]=M,e[39]=I,e[40]=P):P=e[40],P}function he(g){const e=U.c(23),{groups:i,selectedYear:a,toggleYear:c,renderTripCards:o,id:p,hasOverflow:n,contentRef:d}=g;let m;if(e[0]!==i||e[1]!==a||e[2]!==c){let l;e[4]!==a||e[5]!==c?(l=(f,y)=>t.jsx("button",{className:`info-tab-trips__year__button ${a===parseInt(f)?"info-tab-trips__year__button--active":""}`,onClick:()=>c(parseInt(f)),type:"button",children:`${y===0?"â‰¤ ":""}${f}`},f),e[4]=a,e[5]=c,e[6]=l):l=e[6],m=W(i).map(l),e[0]=i,e[1]=a,e[2]=c,e[3]=m}else m=e[3];let r;e[7]!==m?(r=t.jsx("div",{className:"info-tab-trips__header info-tab-trips__year__selector",children:m}),e[7]=m,e[8]=r):r=e[8];const h=`info-tab-trips__content--grouped ${n?"info-tab-trips__content--overflow":""}`;let u;if(e[9]!==i||e[10]!==p||e[11]!==o||e[12]!==a){let l;e[14]!==a?(l=f=>a===parseInt(f),e[14]=a,e[15]=l):l=e[15],u=W(i).filter(l).map(f=>t.jsx("div",{className:"info-tab-trips__year-group",children:a===parseInt(f)?t.jsx("div",{className:`info-tab-trips__content info-tab-${p}__content`,children:o(i[f])}):null},f)),e[9]=i,e[10]=p,e[11]=o,e[12]=a,e[13]=u}else u=e[13];let _;e[16]!==d||e[17]!==h||e[18]!==u?(_=t.jsx("div",{className:h,id:"info-tab",ref:d,children:u}),e[16]=d,e[17]=h,e[18]=u,e[19]=_):_=e[19];let s;return e[20]!==r||e[21]!==_?(s=t.jsxs(t.Fragment,{children:[r,_]}),e[20]=r,e[21]=_,e[22]=s):s=e[22],s}function De(g){const e=U.c(3),{className:i,isVisible:a}=g,c=i===void 0?"":i,o=a===void 0?!1:a;let p;return e[0]!==c||e[1]!==o?(p=t.jsx(_e,{className:c,id:"visited",isVisible:o,trips:ne}),e[0]=c,e[1]=o,e[2]=p):p=e[2],p}export{De as default};
